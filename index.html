<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Monero Browser Miner</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; max-width: 720px; margin: 40px auto; padding: 0 16px; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,.04); }
    button { padding: 10px 16px; border: 1px solid #ddd; border-radius: 10px; cursor: pointer; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: center; }
    .muted { color: #666; font-size: 0.95rem; }
    .warn { background: #fff7e6; border: 1px solid #ffd591; padding: 10px 14px; border-radius: 8px; }
    .ok { color: #0a7; font-weight: 600; }
    code, small { word-break: break-all; }
  </style>
</head>
<body>
  <h1>Monero Browser Miner</h1>
  <p class="muted">This page mines XMR in your browser. Keep your device plugged in and cool. Only run with your own consent.</p>

  <div class="card">
    <div class="grid">
      <div>
        <div><strong>Pool</strong><br><code id="pool">moneroocean.stream</code></div>
      </div>
      <div>
        <div><strong>Wallet</strong><br>
          <small id="addr">452KgFAQWHXSHW6HHSQFy5LUi4cYbcRhxZ1fTXLmJCTaJnMoYjQ7Ra7NQE8TAYKH8ABrHz25FZsBxj5usKfB5mUgHjKaWMV</small>
        </div>
      </div>
    </div>

    <p class="warn">Note: Uses a hosted web miner script. If it’s blocked by your browser or goes offline, mining won’t start.</p>

    <div style="display:flex; gap:10px; margin-top:10px;">
      <button id="startBtn">Start mining</button>
      <button id="stopBtn">Stop</button>
    </div>

    <p class="muted" id="status">Status: idle</p>
  </div>

  <!-- ✅ Correct line to include the miner script -->
  <script src="https://webminer.pages.dev/monero.js"></script>

  <script>
    // ----- Config (you can tweak these) -----
    const pool = "moneroocean.stream";
    const walletAddress = "452KgFAQWHXSHW6HHSQFy5LUi4cYbcRhxZ1fTXLmJCTaJnMoYjQ7Ra7NQE8TAYKH8ABrHz25FZsBxj5usKfB5mUgHjKaWMV";
    const workerId = "browser-demo"; // label at the pool (optional)
    const threads = -1;              // -1 = auto
    const password = "x";            // most pools accept "x"
    const initialThrottle = 20;      // 0..100 (20 ≈ ~80% CPU per core)

    // ----- UI wiring -----
    const status = document.getElementById("status");
    const startBtn = document.getElementById("startBtn");
    const stopBtn  = document.getElementById("stopBtn");

    function setStatus(msg, ok=false) {
      status.textContent = "Status: " + msg;
      status.className = ok ? "ok" : "muted";
      console.log("[miner]", msg);
    }

    function start() {
      try {
        if (typeof startMining !== "function") {
          setStatus("miner script loaded but API not found (check if blocked by extensions).");
          console.error("startMining() is not available. The script may be blocked.");
          return;
        }
        startMining(pool, walletAddress, workerId, threads, password);
        // global throttling variable used by many webminer builds
        if (typeof throttleMiner !== "undefined") {
          throttleMiner = initialThrottle;
        }
        setStatus("mining… keep this tab open.", true);
      } catch (e) {
        console.error(e);
        setStatus("error starting miner (open browser console).");
      }
    }

    function stop() {
      try {
        if (typeof stopMining === "function") {
          stopMining();
          setStatus("stopped");
        } else {
          setStatus("cannot stop (API missing).");
        }
      } catch (e) {
        console.error(e);
        setStatus("error stopping miner.");
      }
    }

    startBtn.addEventListener("click", start);
    stopBtn .addEventListener("click", stop);
  </script>

  <p class="muted" style="margin-top:16px;">
    To see earnings, open your pool’s dashboard and paste your wallet address. (Propagation can take a few minutes.)
  </p>
</body>
</html>
